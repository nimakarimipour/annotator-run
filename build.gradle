plugins {
    id 'java'
    id "net.ltgt.errorprone" version "4.0.1"
}

repositories {
    mavenLocal()
    mavenCentral()
}

dependencies {


    errorprone "com.uber.nullaway:nullaway:0.10.25"
    errorprone "edu.ucr.cs.riple.annotator:annotator-scanner:1.3.14"
    compileOnly "com.google.code.findbugs:jsr305:3.0.2"
    errorprone "com.google.errorprone:error_prone_core:2.28.0"
    compileOnly "com.uber.nullaway:nullaway-annotations:0.10.25"
}

// path to root
def scanner_path = projectDir.absolutePath + "/annotator-out/scanner.xml"
def nullaway_path = projectDir.absolutePath + "/annotator-out/nullaway.xml"

import net.ltgt.gradle.errorprone.CheckSeverity
tasks.withType(JavaCompile) {
        options.errorprone {
            check("NullAway", CheckSeverity.ERROR)
            check("AnnotatorScanner", CheckSeverity.ERROR)
            option("NullAway:AnnotatedPackages", "org.example")
            option("NullAway:SerializeFixMetadata", "true")
            option("NullAway:FixSerializationConfigPath", nullaway_path)
            option("AnnotatorScanner:ConfigPath",  scanner_path)
        }
}
